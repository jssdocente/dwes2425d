# 7.1 Instalar Laravel y primeras rutas.

En esta primera lecci√≥n, crearemos un nuevo proyecto con Laravel. La [p√°gina de instalaci√≥n de](https://laravel.com/docs/installation) la documentaci√≥n oficial de Laravel tiene mucha informaci√≥n. Hay m√°s de una forma de instalar Laravel.

La documentaci√≥n oficial de Laravel se basa principalmente en una herramienta llamada [Laravel Sail](https://laravel.com/docs/sail) , que se basa en [Docker](https://www.docker.com/) . Pero no utilizaremos Sail ni docker en esta serie de tutoriales.

Mi preferencia personal es utilizar [el instalador de Laravel](https://laravel.com/docs/installation#creating-a-laravel-project) .

Pero antes de usar el instalador, necesitamos preparar su m√°quina.

---

## Preparaci√≥n de su computadora: Composer y Web-Server

Para instalar Laravel, primero debes instalar [Composer](https://getcomposer.org/) en tu m√°quina. Composer se utiliza posteriormente para instalar todos los paquetes de Laravel.

A continuaci√≥n, debe tener un **servidor web PHP** en su m√°quina. Existen diferentes herramientas "en paquete" para distintos sistemas operativos, entre las que se incluyen Nginx/Apache, PHP, MySQL y algunas otras para proyectos web PHP:

- Laravel Herd (Windows/MacOS)
- Laravel Valet (MacOS/Linux)
- Laragon/XAMPP (Windows)
- etc.

Como hemos usado en todo el curso la herramienta *Laravel Herd*, vamos a seguir con ella.

> üî• Laravel 11 requiere al menos la versi√≥n PHP 8.2.

Con Laravel Herd ya viene instalado Composer, PHP, MySQL,  Nginx y tambi√©n el instalador de Laravel, por lo que no necesitamos instalar nada m√°s.


## Instalar y Lanzar Laravel

Para crear un nuevo proyecto de Laravel, simplemente ejecute el siguiente comando en su terminal:

```bash
laravel new lv-webapp
```

> üìÅ ¬øD√≥nde crear el proyecto? Da igual, la ruta elegida simplemente tiene que estar agregada a Laravel Herd para que pueda crear un dominio.test para visualizar el proyecto.

Al crear un proyecto con `laravel` se iniciar√° un asistente donde con una serie de opciones. Seguir los pasos que se muestran en el siguiente video:

[![Instalar Laravel](./img/01.create-proyect.gif)

> *Ahora vaya a Laravel Herd, sites, y configure el nuevo sitio para aplicar seguridad HTTPS.*

Este comando crear√° un nuevo proyecto de Laravel en un directorio llamado `lv-webapp`. Para visualizar el proyecto, simplemente abra un navegador y vaya a `http://lv-webapp.test`.

Una vez accedemos a la URL, veremos la p√°gina de inicio de Laravel.

![P√°gina de inicio de Laravel](./img/02.laravel-home.png)

## Abrir proyecto en PHPStorm

Ahora que tenemos el proyecto creado, vamos a abrirlo en PHPStorm. Para ello, simplemente abrimos PHPStorm y seleccionamos la opci√≥n de abrir un proyecto o arrastramos la carpeta del proyecto al IDE.

Las rutas de Laravel se encuentran en el archivo `routes/web.php`. En este archivo se definen las rutas de la aplicaci√≥n. Por ejemplo, la ruta de la p√°gina de inicio es:

```php
use Illuminate\Support\Facades\Route;
 
Route::get('/', function () {
    return view('welcome');
});
```

Tenemos una p√°gina de inicio, que lleva a una vista llamada `welcome`. Las vistas se encuentran en la carpeta `resources/views`.

Pues de una forma tan sencilla, !hemos instalado Laravel!

> ‚ÑπÔ∏è Alguna duda? puedes ver el siguiente [video](https://laracasts.com/series/30-days-to-learn-laravel-11/episodes/1) que explica estos pasos con m√°s detalle.


### Rutas B√°sicas

Dependiende de la complejidad de la aplicaci√≥n, las rutas pueden ser m√°s complejas o m√°s sencillas. Sin simplemente se desea mostrar una p√°gina de inicio, digamos est√°tica, sin contenido din√°mico, no har√≠a falta un controlador, y por tanto lo √∫nico necesario ser√≠a llamar a la vista directamente desde la ruta.

Para definir una ruta en Laravel, se utiliza la clase `Route` de forma est√°tica, indicamos el `verbo http` como un m√©todo est√°tico, utilizando 2 par√°metros.

- El primero es la ruta en s√≠, que es un string.
- El segundo es un `closure` o funci√≥n an√≥nima que se ejecuta cuando se accede a la ruta. Esta funci√≥n retornar√° una vista, un string, un json, etc. En este caso, retornamos una vista. Para llamar a la vista, simplemente utilizamos la funci√≥n `view()` y pasamos el nombre de la vista.

```php
use Illuminate\Support\Facades\Route;

Route::get('/', function () {
    return view('welcome');
});
```

`View` es una plantilla escrita en un lenguaje espec√≠fico de Laravel llamado Blade. Puedes pensar en un archivo Blade como un archivo HTML con variables en su interior.<br>
La parte `welcome` en el c√≥digo significa que el archivo est√° en una carpeta `resources/views` con la extensi√≥n `.blade.php`. Esta extensi√≥n es crucial.
En ese archivo `welcome.blade.php`, tenemos HTML con algo de sintaxis de Blade como `@if` o `@auth`. Cambiemos un poco el texto en la vista.

Vamos a hacer un cambio en el archivo `welcome.blade.php`, cambiando el texto de la vista de inicio, como se indican a continuaci√≥n:

**resources/views/welcome.blade.php**:

```php
// ...
    <p class="mt-4 text-sm/relaxed">
      // quitar
        Laravel has wonderful documentation covering every aspect of the framework. Whether you are a newcomer or have prior experience with Laravel, we recommend reading our documentation from beginning to end. 
      // a√±adir
        Laravel framework has wonderful documentation covering every aspect of the framework. Whether you are a newcomer or have prior experience with Laravel, we recommend reading our documentation from beginning to end. 
    </p>
// ...
```

Recarga la p√°gina en el navegador y ver√°s el cambio en el texto.

![P√°gina de inicio de Laravel](./img/03.laravel-route-home.png)


Ahora vamos a agregar una nueva ruta:

**routes/web.php**:

```php
Route::get('/', function () {
    return view('welcome');
});

// Nueva ruta
Route::get('/second', function () { 
    return view('second');
});
```

Esto har√° `project.test/second` este ruta disponible, y retornar√° una vista llamada `second.blade.php`, pero el problema es que si navegamos a esa ruta, veremos un error, ya que la vista `second.blade.php` no existe.

En lugar de devolver una vista, podemos devolver cualquier cosa, un string, un json, etc. Pero en este caso, devolveremos una vista.

Copia la vista `welcome.blade.php` y ren√≥mbrala a `second.blade.php`. Cambia el texto de la vista.

Si ahora accedes de nuevo, ver√°s que ya no hay error, y la vista `second.blade.php` se muestra correctamente.

![P√°gina second](./img/04.laravel-route-second.png)

Y si visitamos una ruta que no existe, Laravel mostrar√° un error 404.

![P√°gina 404](./img/05.laravel-route-noexist.png)

As√≠ es como se crean rutas y p√°ginas en Laravel con el lenguaje Blade.
De hecho, las p√°ginas tendr√°n m√°s l√≥gica en proyectos reales, pero llegaremos a eso un poco m√°s tarde. Un paso a la vez.

Pero si tienes el caso de p√°ginas est√°ticas similares con solo un archivo Blade y sin mucha l√≥gica, puedes usar una sintaxis m√°s corta en el archivo de rutas: en lugar de Route::get() y una funci√≥n de devoluci√≥n de llamada, haz Route::view() y proporciona el nombre del archivo Blade como segundo par√°metro.

```php
//Forma larga
Route::get('/second', function () { 
    return view('second'); 
}); 
 
//Forma corta. El m√©todo que se utiliza por defecto es GET
Route::view('/second', 'second'); 
```
!!! info "Alguna duda?"
    puedes ver el siguiente [video](https://laracasts.com/series/30-days-to-learn-laravel-11/episodes/2) que explica estos pasos con m√°s detalle.

### √öLTIMOS PASOS

**Generar key de la aplicaci√≥n**

Laravel necesita una clave de aplicaci√≥n para funcionar correctamente. Para generar una clave de aplicaci√≥n, simplemente ejecute el siguiente comando en su terminal:

```bash
php artisan key:generate
```

Tambi√©n puede ser que la Base de Datos no existe (en caso de haber elegido SQLite como base de datos). Para crear la base de datos, simplemente ejecute el siguiente comando en su terminal:

```bash
touch database/database.sqlite
```

**Configuar .gitignore**

En nuestro caso y como estamos realizando un repositorio para trabajar en casa y en clase, vamos a quitar del `.gitignore` el archivo .env, para que podamos tener la configuraci√≥n compartida entre clase y casa.

